
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Phase two implementation proposal &mdash; GeoServer 2.2.x Developer Manual</title>
  <link rel="stylesheet" href="../../../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../../_static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.2.x',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../../searchindex.js"></script>
      <link rel="top" title="GeoServer 2.2.x Developer Manual" href="../../../index.html" />
      <link rel="up" title="Versioning implementation" href="implementation.html" />
      <link rel="next" title="Introduction" href="../gss/introduction.html" />
      <link rel="prev" title="Versioning WFS - Sample calls" href="samplecalls.html" />
</head>
<body class="programming-guide/versioning/wfsv/phase2">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../../index.html">GeoServer 2.2.x Developer Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/display/GEOS/What+is+Geoserver">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/display/GEOS/Download">Download</a></li>
        <li><a href="../../../index.html">Documentation</a></li>
      </ul>
        <form id="quick-search" action="../../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../../_static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../../index.html">GeoServer 2.2.x Developer Manual</a> &raquo;</li>
  <li><a href="../../index.html" accesskey="U">Programming Guide</a> &raquo;</li>
  <li><a href="../index.html" accesskey="U">Versioning</a> &raquo;</li>
  <li><a href="implementation.html" accesskey="U">Versioning implementation</a> &raquo;</li>
  <li>Phase two implementation proposal</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../gss/introduction.html" title="Introduction"
       accesskey="N">next</a></li>
  <li>
    <a href="samplecalls.html" title="Versioning WFS - Sample calls"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="phase-two-implementation-proposal">
<span id="versioning-implementation-phase2"></span><h1>Phase two implementation proposal<a class="headerlink" href="#phase-two-implementation-proposal" title="Permalink to this headline">¶</a></h1>
<p>Branching support could be added to the previous design by using an approach similar to Oracle and ArcSDE, that is, tagging each &#8220;path&#8221; in the versioning tree with a number, and creating a new one each time a tag or a branch is created. This number is called componentId here.</p>
<img alt="../../../_images/versioningBranches.jpg" src="../../../_images/versioningBranches.jpg" />
<p>The <strong>BranchTag</strong>  table holds both tag and branch names (branch is used to discriminate branches and tags) and <strong>ComponentLineage</strong> holds a set of all fathers of a specific path component so that the whole path that let to a specific branch can be rebuilt.</p>
<p>Of course all the above queries can be modified to take into account branches adding extra subqueries, and thus adding a performance overhead. On the bright side, this schema allows for cheap branching (since it does not have to create extra row copies).</p>
<div class="section" id="taking-into-consideration-branches-in-the-api">
<h2>Taking into consideration branches in the API<a class="headerlink" href="#taking-into-consideration-branches-in-the-api" title="Permalink to this headline">¶</a></h2>
<p>The DataStore API provides reading hooks for versioning using Query.getVersion() which is a string and can be freely intepreted. So, if we wanted to encode version 10 of branch &#8220;gizmo&#8221; we would use &#8220;gizmo:10&#8221;.</p>
<p>Writing does not use Query at all. In the no branch case, all the relevant informations such as user and commit message have been encoded as Transaction properties. Version is no need in this picture, because we cannot write again a specific revision, but only against &#8220;latest&#8221;.
When branch comes into the picture, we see that branch information need to be encoded as a transaction property, leaving to a bit of inconsistency, because in the reading case it makes more sense to have it in the Query (it matches the WFS level) whilst in the writing case we need to encode it in the transaction.
Moreover, phase one did not leave any place to store the branch information, unless we devise some fancy way to provide that one along with the handle (not really good looking). This leaves us out to encode branch information in a new attribute, something we tried to avoid with commit message included as the handle.</p>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="samplecalls.html" title="previous chapter">Versioning WFS - Sample calls</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="../gss/introduction.html" title="next chapter">Introduction</a></div>
      </div>
      </div><!-- /#content> -->
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Phase two implementation proposal</a><ul>
<li><a class="reference internal" href="#taking-into-consideration-branches-in-the-api">Taking into consideration branches in the API</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="samplecalls.html" title="previous chapter">Versioning WFS - Sample calls</a></li>
            <li>Next: <a href="../gss/introduction.html" title="next chapter">Introduction</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../../../_sources/programming-guide/versioning/wfsv/phase2.txt">Show Source</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright 2011 GeoServer.
    Last updated on Jan 04, 2013.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>