
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>KML Placemark Templates &mdash; GeoServer 2.2.x User Manual</title>
  <link rel="stylesheet" href="../../../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../../_static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.2.x',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../../searchindex.js"></script>
      <link rel="top" title="GeoServer 2.2.x User Manual" href="../../../index.html" />
      <link rel="up" title="Tutorials" href="../index.html" />
      <link rel="next" title="Heights Templates" href="../heights/heights.html" />
      <link rel="prev" title="Tutorials" href="../index.html" />
</head>
<body class="googleearth/tutorials/kmlplacemark/index">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../../index.html">GeoServer 2.2.x User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/display/GEOS/What+is+Geoserver">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/display/GEOS/Download">Download</a></li>
        <li><a href="../../../index.html">Documentation</a></li>
      </ul>
        <form id="quick-search" action="../../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../../_static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../../index.html">GeoServer 2.2.x User Manual</a> &raquo;</li>
  <li><a href="../../index.html" accesskey="U">Google Earth</a> &raquo;</li>
  <li><a href="../index.html" accesskey="U">Tutorials</a> &raquo;</li>
  <li>KML Placemark Templates</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../heights/heights.html" title="Heights Templates"
       accesskey="N">next</a></li>
  <li>
    <a href="../index.html" title="Tutorials"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="kml-placemark-templates">
<span id="getutorial-kmlplacemark"></span><h1>KML Placemark Templates<a class="headerlink" href="#kml-placemark-templates" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In KML a &#8220;Placemark&#8221; is used to mark a position on a map, often visualized with a yellow push pin. A placemark can have a &#8220;description&#8221; which allows one to attach information to it. Placemark descriptions are nothing more then an HTML snippet and can contain anything we want it to.</p>
<p>By default GeoServer produces placemark descriptions which are HTML tables describing all the attributes available for a particular feature in a dataset. In the following image we see the placemark description for the feature representing Idaho state:</p>
<div class="figure align-center">
<img alt="../../../_images/default.jpg" src="../../../_images/default.jpg" />
<p class="caption"><em>The default placemark</em></p>
</div>
<p>This is great, but what about if one wanted some other sort of information to be conveyed in the description. Or perhaps one does not want to show all the attributes of the dataset. The answer is Templates!!</p>
<p>A template is more or less a way to create some output.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>First let us get set up. To complete the tutorial you will need the following:</p>
<ul class="simple">
<li>A GeoServer install</li>
<li>A text editor</li>
</ul>
<p>And thats it. For this tutorial we will assume that GeoServer is running the same configuration ( data directory ) that it does out of the box.</p>
</div>
<div class="section" id="hello-world">
<h2>Hello World<a class="headerlink" href="#hello-world" title="Permalink to this headline">¶</a></h2>
<p>Ok, time to get to creating our first template. We will start off an extremely simple template which, you guessed it, creates the placemark description &#8220;Hello World!&#8221;. So lets go.</p>
<ol class="arabic">
<li><p class="first">Using the text editor of your choice start a new file called <tt class="docutils literal"><span class="pre">description.ftl</span></tt></p>
</li>
<li><p class="first">Add the following content to the file:</p>
<div class="highlight-python"><pre>Hello World!</pre>
</div>
</li>
<li><p class="first">Save the file in the <tt class="docutils literal"><span class="pre">workspaces/topp/states_shapefile/states</span></tt> directory of your &#8220;data directory&#8221;. The data directory is the location of all the GeoServer configuration files. It is normally pointed to by the environment variable <tt class="docutils literal"><span class="pre">GEOSERVER_DATA_DIR</span></tt>.</p>
</li>
<li><p class="first">Start GeoServer is it is not already running.</p>
</li>
</ol>
<p>And thats it. We can now test out our template by adding the following network link in google earth:</p>
<div class="highlight-python"><pre>http://localhost:8080/geoserver/wms/kml?layers=states</pre>
</div>
<p>And voila. Your first template</p>
<blockquote>
<div><div class="figure align-center">
<img alt="../../../_images/helloworld.png" src="../../../_images/helloworld.png" />
<p class="caption"><em>Hello World template.</em></p>
</div>
</div></blockquote>
<p><strong>Refreshing Templates</strong>: One nice aspect of templates is that they are read upon every request. So one can simply edit the template in place and have it picked up by Geoserver as soon as the file is saved. So when after editing and saving a template simply &#8220;Refresh&#8221; the network link in Google Earth to have the new content picked up.</p>
<blockquote>
<div><div class="figure align-center">
<img alt="../../../_images/refresh.png" src="../../../_images/refresh.png" />
<p class="caption"><em>Refresh Template</em></p>
</div>
</div></blockquote>
<p>As stated before template descriptions are nothing more than html. Play around with <tt class="docutils literal"><span class="pre">description.ftl</span></tt> and add some of your own html. Some examples you may want to try:</p>
<ol class="arabic">
<li><p class="first">A simple link to the homepage of your organization:</p>
<div class="highlight-python"><pre>Provided by the &lt;a href="http://topp.openplans.org"&gt;The Open Planning Project&lt;/a&gt;.</pre>
</div>
</li>
</ol>
<p>Homepage of Topp</p>
<blockquote>
<div><div class="figure align-center">
<img alt="../../../_images/topplink.png" src="../../../_images/topplink.png" />
<p class="caption"><em>Homepage of Topp</em></p>
</div>
</div></blockquote>
<ol class="arabic" start="2">
<li><p class="first">The logo of your organization:</p>
<div class="highlight-python"><pre>&lt;img src="http://topp.openplans.org/images/logo.jpg"/&gt;</pre>
</div>
</li>
</ol>
<p>Logo of Topp</p>
<blockquote>
<div><div class="figure align-center">
<img alt="../../../_images/topplogo.png" src="../../../_images/topplogo.png" />
<p class="caption"><em>Logo of Topp</em></p>
</div>
</div></blockquote>
<p>The possibilities are endless. Now this is all great and everything but these examples are some what lacking in that the content is static. In the next section we will create more realistic template which actually access some the attributes of our data set.</p>
</div>
<div class="section" id="data-content">
<h2>Data Content<a class="headerlink" href="#data-content" title="Permalink to this headline">¶</a></h2>
<p>The real power of templates is the ability to easily access content, in the case of features this content is the attributes of features.In a KML placemark description template, there are a number of &#8220;template variables&#8221; available.</p>
<ul class="simple">
<li>The variable &#8220;fid&#8221;, which corresponds to the id of the feature</li>
<li>The variable &#8220;typeName&#8221;, which corresponds to the name of the type of the feature</li>
<li>A sequence of variables corresponding to feature attributes, each named the same name as the attribute</li>
</ul>
<p>So with this knowledge in hand let us come up with some more examples:</p>
<p>Simple fid/typename access:</p>
<div class="highlight-python"><pre>This is feature ${fid} of type ${typeName}.</pre>
</div>
<p>This is a feature of 3.1 of type states.</p>
<div class="figure align-center">
<img alt="../../../_images/fid.png" src="../../../_images/fid.png" />
<p class="caption"><em>FID</em></p>
</div>
<p>Access to the values of two attributes named <tt class="docutils literal"><span class="pre">STATE_NAME</span></tt>, and <tt class="docutils literal"><span class="pre">PERSONS</span></tt>:</p>
<div class="highlight-python"><pre>This is ${STATE_NAME.value} state which has a population of ${PERSONS.value}.</pre>
</div>
<p>ID This is Idaho state which has a population of 1.006.749.</p>
<div class="figure align-center">
<img alt="../../../_images/attributes.png" src="../../../_images/attributes.png" />
<p class="caption"><em>Attributes</em></p>
</div>
</div>
<div class="section" id="attribute-variables">
<h2>Attribute Variables<a class="headerlink" href="#attribute-variables" title="Permalink to this headline">¶</a></h2>
<p>A feature attribute a &#8220;complex object&#8221; which is made up of three parts:</p>
<ol class="arabic simple">
<li><strong>A value</strong>, given as a default string representation of the actual attribute value feasible to be used directly</li>
<li><strong>A rawValue</strong>, being the actual value of the attribute, to allow for more specialized customization (for example, <tt class="docutils literal"><span class="pre">${attribute.value?string(&quot;Enabled&quot;,</span> <span class="pre">&quot;Disabled&quot;)}</span></tt> for custom representations of boolean attributes, etc).</li>
<li><strong>A type</strong>, each of which is accessible via <tt class="docutils literal"><span class="pre">${&lt;attribute_name&gt;.name}</span></tt>, <tt class="docutils literal"><span class="pre">${&lt;attribute_name&gt;.value},</span> <span class="pre">${&lt;attribute_name&gt;.rawValue}</span></tt>, <tt class="docutils literal"><span class="pre">${&lt;attribute_name&gt;.type}</span></tt> respectively. The other variables: fid, and typeName and are &#8220;simple objects&#8221; which are available directly.</li>
</ol>
</div>
<div class="section" id="wms-demo-example">
<h2>WMS Demo Example<a class="headerlink" href="#wms-demo-example" title="Permalink to this headline">¶</a></h2>
<p>We will base our final example off the &#8220;WMS Example&#8221; demo which ships with GeoServer. To check out the demo visit <a class="reference external" href="http://localhost:8080/geoserver/popup_map/index.html">http://localhost:8080/geoserver/popup_map/index.html</a> in your web browser.</p>
<p>You will notice that hovering the mouse over one of the points on the map displays an image specific to that point. Let us replicate this with a KML placemark description.</p>
<ol class="arabic">
<li><p class="first">In the <tt class="docutils literal"><span class="pre">featureTypes/DS_poi_poi</span></tt> directory of the geoserver data directory create the following template:</p>
<div class="highlight-python"><pre>&lt;img src="http://localhost:8080/geoserver/popup_map/${THUMBNAIL.value}"/&gt;</pre>
</div>
</li>
<li><p class="first">Add the following network link in Google Earth:</p>
<div class="highlight-python"><pre>http://localhost:8080/geoserver/wms/kml_reflect?layers=tiger:poi</pre>
</div>
</li>
</ol>
<p>Poi.4</p>
<div class="figure align-center">
<img alt="../../../_images/wmsexample.png" src="../../../_images/wmsexample.png" />
<p class="caption"><em>WMS Example</em></p>
</div>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="../index.html" title="previous chapter">Tutorials</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="../heights/heights.html" title="next chapter">Heights Templates</a></div>
      </div>
      </div><!-- /#content> -->
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">KML Placemark Templates</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li><a class="reference internal" href="#hello-world">Hello World</a></li>
<li><a class="reference internal" href="#data-content">Data Content</a></li>
<li><a class="reference internal" href="#attribute-variables">Attribute Variables</a></li>
<li><a class="reference internal" href="#wms-demo-example">WMS Demo Example</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="../index.html" title="previous chapter">Tutorials</a></li>
            <li>Next: <a href="../heights/heights.html" title="next chapter">Heights Templates</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../../../_sources/googleearth/tutorials/kmlplacemark/index.txt">Show Source</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright GeoServer.
    Last updated on Jan 04, 2013.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>