
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Key authentication module &mdash; GeoServer 2.2.x User Manual</title>
  <link rel="stylesheet" href="../../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../_static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.2.x',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../searchindex.js"></script>
      <link rel="top" title="GeoServer 2.2.x User Manual" href="../../index.html" />
      <link rel="up" title="Community" href="../index.html" />
      <link rel="next" title="CSS Styling" href="../css/index.html" />
      <link rel="prev" title="Community" href="../index.html" />
</head>
<body class="community/authkey/index">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../index.html">GeoServer 2.2.x User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/display/GEOS/What+is+Geoserver">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/display/GEOS/Download">Download</a></li>
        <li><a href="../../index.html">Documentation</a></li>
      </ul>
        <form id="quick-search" action="../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../_static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../index.html">GeoServer 2.2.x User Manual</a> &raquo;</li>
  <li><a href="../index.html" accesskey="U">Community</a> &raquo;</li>
  <li>Key authentication module</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../css/index.html" title="CSS Styling"
       accesskey="N">next</a></li>
  <li>
    <a href="../index.html" title="Community"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="key-authentication-module">
<span id="authkey"></span><h1>Key authentication module<a class="headerlink" href="#key-authentication-module" title="Permalink to this headline">¶</a></h1>
<p>The <tt class="docutils literal"><span class="pre">authkey</span></tt> module for GeoServer allows for a very simple authentication protocol designed for
OGC clients that cannot handle any kind of security protocol, not even the HTTP basic authentication.</p>
<p>For these clients the module allows a minimal form of authentication by appending a unique key in the
URL that is used as the sole authentication token. Obviously this approach is open to security token
sniffing and must always be associated with the use of HTTPS connections.</p>
<p>A sample authenticated request looks like:</p>
<div class="highlight-python"><pre>http://localhost:8080/geoserver/topp/wms?service=WMS&amp;version=1.3.0&amp;request=GetCapabilities&amp;authkey=ef18d7e7-963b-470f-9230-c7f9de166888</pre>
</div>
<p>Where <tt class="docutils literal"><span class="pre">authkey=ef18d7e7-963b-470f-9230-c7f9de166888</span></tt> is associated to a specific user (more on this later).
The capabilities document contains backlinks to the server itself, linking to the URLs that can be used
to perform GetMap, GetFeatureInfo and so on.
When the <tt class="docutils literal"><span class="pre">authkey</span></tt> parameter is provided the backlinks will contain the authentication key as well,
allowing any compliant WMS client to access secured resources.</p>
<div class="section" id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">authkey</span></tt> module is meant to be used with OGC services. It won&#8217;t work properly against the
administration GUI, nor RESTConfig.</p>
</div>
<div class="section" id="the-default-key-provider">
<h2>The default key provider<a class="headerlink" href="#the-default-key-provider" title="Permalink to this headline">¶</a></h2>
<p>By default the authentication module uses a property file located at <tt class="docutils literal"><span class="pre">$GEOSERVER_DATA_DIR/security/authkeys.propeties</span></tt>
containing a mapping between the keys and the user names. A sample file looks as follows:</p>
<div class="highlight-python"><pre># Format is authkey=username
b52d2068-0a9b-45d7-aacc-144d16322018=admin
1825efd3-20e1-4c18-9648-62c97d3ee5cb=sf
ef18d7e7-963b-470f-9230-c7f9de166888=topp</pre>
</div>
<p>If the file is missing by default the module will generate a new one where each existing user is
associated to a automatically generated unique key, and a hash mark in front to disable them: you can
remove the hashmark to enable key authentication a specific user.</p>
</div>
<div class="section" id="provider-pluggability">
<h2>Provider pluggability<a class="headerlink" href="#provider-pluggability" title="Permalink to this headline">¶</a></h2>
<p>With some Java programming it is possible to programmatically create and register a new key to user
name mapper that works under a different logic.
For example, you could have daily tokens, token generators and the like.</p>
<p>In order to provide your custom mapper you have to implement the <tt class="docutils literal"><span class="pre">org.geoserver.securityAuthenticationKeyMapper</span></tt>
interface and then register said bean in the Spring application context. A very simple mapper statically
associating the <tt class="docutils literal"><span class="pre">superpowers</span></tt> key to the administrator would look as follows:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SuperpowersMapper</span> <span class="kd">implements</span> <span class="n">AuthenticationKeyMapper</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getUserName</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span><span class="o">(</span><span class="s">&quot;superpowers&quot;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">key</span><span class="o">))</span> <span class="o">{</span>
          <span class="k">return</span> <span class="s">&quot;admin&quot;</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
           <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<p>The mapper would have to be registered in the Spring application context in a <tt class="docutils literal"><span class="pre">applicationContext.xml</span></tt>
file in the root of your jar. For example:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE beans PUBLIC &quot;-//SPRING//DTD BEAN//EN&quot; &quot;http://www.springframework.org/dtd/spring-beans.dtd&quot;&gt;</span>
<span class="nt">&lt;beans&gt;</span>
  <span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;superpowersMapper&quot;</span> <span class="na">class=</span><span class="s">&quot;com.mycompany.security.SuperpowersMapper&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/beans&gt;</span>
</pre></div>
</div>
<p>At this point you can drop the <tt class="docutils literal"><span class="pre">authkey</span></tt> jar along with your custom mapper jar and the module
will pick up your mapper instead of the default property based one.</p>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="../index.html" title="previous chapter">Community</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="../css/index.html" title="next chapter">CSS Styling</a></div>
      </div>
      </div><!-- /#content> -->
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Key authentication module</a><ul>
<li><a class="reference internal" href="#limitations">Limitations</a></li>
<li><a class="reference internal" href="#the-default-key-provider">The default key provider</a></li>
<li><a class="reference internal" href="#provider-pluggability">Provider pluggability</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="../index.html" title="previous chapter">Community</a></li>
            <li>Next: <a href="../css/index.html" title="next chapter">CSS Styling</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../../_sources/community/authkey/index.txt">Show Source</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright GeoServer.
    Last updated on Jan 04, 2013.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>