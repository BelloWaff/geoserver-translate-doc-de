
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Passwords &mdash; GeoServer 2.2.x User Manual</title>
  <link rel="stylesheet" href="../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../_static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../_static/default.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.2.x',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/searchtools.js"></script>
  <script type="text/javascript" src="../searchindex.js"></script>
      <link rel="top" title="GeoServer 2.2.x User Manual" href="../index.html" />
      <link rel="up" title="Security" href="index.html" />
      <link rel="next" title="Root account" href="root.html" />
      <link rel="prev" title="Authentication providers" href="auth/providers.html" />
</head>
<body class="security/passwd">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../index.html">GeoServer 2.2.x User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/display/GEOS/What+is+Geoserver">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/display/GEOS/Download">Download</a></li>
        <li><a href="../index.html">Documentation</a></li>
      </ul>
        <form id="quick-search" action="../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../_static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../index.html">GeoServer 2.2.x User Manual</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">Security</a> &raquo;</li>
  <li>Passwords</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="root.html" title="Root account"
       accesskey="N">next</a></li>
  <li>
    <a href="auth/providers.html" title="Authentication providers"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="passwords">
<span id="sec-passwd"></span><h1>Passwords<a class="headerlink" href="#passwords" title="Permalink to this headline">¶</a></h1>
<p>Passwords are a central aspect of any security system. This section describes how GeoServer handles passwords.</p>
<div class="section" id="password-encryption">
<span id="sec-passwd-encryption"></span><h2>Password encryption<a class="headerlink" href="#password-encryption" title="Permalink to this headline">¶</a></h2>
<p>A GeoServer configuration stores two types of passwords:</p>
<ul class="simple">
<li>Passwords for <strong>user accounts</strong> to access GeoServer resources</li>
<li>Passwords used internally for <strong>accessing external services</strong> such as databases and cascading OGC services</li>
</ul>
<p>As these passwords are typically stored on disk it is strongly recommended that they be encrypted and not stored as human-readable text. GeoServer security provides four schemes for encrypting passwords: <strong>empty</strong>, <strong>plain text</strong>, <strong>Digest</strong>, and <strong>Password-based encryption (PBE)</strong>.</p>
<p>The password encryption scheme is specified as a global setting that affects the encryption of passwords used for external resources, and as an encryption scheme for each <a class="reference internal" href="usergrouprole/usergroupservices.html#sec-rolesystem-usergroupservices"><em>user/group service</em></a>. The encryption scheme for external resources has to be be <a class="reference internal" href="#sec-passwd-reversible"><em>reversible</em></a>, while the user/group services can use any scheme.</p>
<div class="section" id="empty">
<h3>Empty<a class="headerlink" href="#empty" title="Permalink to this headline">¶</a></h3>
<p>The scheme is not reversible. Any password is encoded as an empty string, and as a consequence it is not possible to recalculate the plain text password. This scheme is used for user/group services in combination with an authentication mechanism using a back end system. Examples are user name/password authentication against a LDAP server or a JDBC database. In these scenarios, storing passwords locally to Geoserver does not make sense.</p>
</div>
<div class="section" id="plain-text">
<h3>Plain text<a class="headerlink" href="#plain-text" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Prior to version 2.2.0, plain text encryption was the only available method used by GeoServer for storing passwords.</p>
</div>
<p>Plain text passwords provide no encryption at all. In this case, passwords are human-readable by anyone who has access to the file system. For obvious reasons, this is not recommended for any but the most basic test server. A password <tt class="docutils literal"><span class="pre">mypassword</span></tt> is encoded as <tt class="docutils literal"><span class="pre">plain:mypassword</span></tt>, the prefix uniquely describing the algorithm used for encoding/decoding.</p>
</div>
<div class="section" id="digest">
<h3>Digest<a class="headerlink" href="#digest" title="Permalink to this headline">¶</a></h3>
<p>Digest encryption is not reversible. It applies, 100,000 times through an iterative process, a SHA-256 <a class="reference external" href="http://en.wikipedia.org/wiki/Cryptographic_hash_function">cryptographic hash function</a>
to passwords. This scheme is &#8220;one-way&#8221; in that it is virtually impossible to reverse and obtain the original password from its hashed representation. Please see the section on <a class="reference internal" href="#sec-passwd-reversible"><em>Reversible encryption</em></a> for more information on reversibility.</p>
<p>To protect from well known attacks, a random value called a <a class="reference external" href="http://en.wikipedia.org/wiki/Salt_%28cryptography%29">salt</a> is added to the password when generating the key. For each digesting, a separate random salt is used. Digesting the same password twice results in different hashed representations.</p>
<p>As an example, the password <tt class="docutils literal"><span class="pre">geoserver</span></tt> is digested to <tt class="docutils literal"><span class="pre">digest1:YgaweuS60t+mJNobGlf9hzUC6g7gGTtPEu0TlnUxFlv0fYtBuTsQDzZcBM4AfZHd</span></tt>.
<tt class="docutils literal"><span class="pre">digest1</span></tt> indicates the usage of digesting. The hashed representation and the salt are base 64 encoded.</p>
</div>
<div class="section" id="password-based-encryption">
<h3>Password-based encryption<a class="headerlink" href="#password-based-encryption" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://www.javamex.com/tutorials/cryptography/password_based_encryption.shtml">Password-based encryption</a> (PBE) normally employs a user-supplied password to generate an encryption key. This scheme is reversible. A random salt described in the previous section is used.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The system never uses passwords specified by users because these passwords tend to be weak. Passwords used for encryption are generated using a secure random generator and stored in the GeoServer key store. The number of possible passwords is 2^260 .</p>
</div>
<p>GeoServer supports two forms of PBE. <strong>Weak PBE</strong> (the GeoServer default) uses a basic encryption method that is relatively easy to crack. The encryption key is derived from the password using <a class="reference external" href="http://en.wikipedia.org/wiki/Message_Digest_Algorithm_5">MD5</a> 1000 times iteratively. The encryption algorithm itself is <a class="reference external" href="http://en.wikipedia.org/wiki/Data_Encryption_Standard">DES</a> (Data Encryption Standard). DES has an effective key length of 56 bits, which is not really a challenge for computer systems in these days.</p>
<p><strong>Strong PBE</strong> uses a much stronger encryption method based on an <a class="reference external" href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES</a> 256-bit algorithm with <a class="reference external" href="http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation">CBC</a>. The key length is 256 bit and is derived using <a class="reference external" href="http://en.wikipedia.org/wiki/SHA-2">SHA-256</a> instead of MD5. Using Strong PBE is highly recommended.</p>
<p>As an example, the password <tt class="docutils literal"><span class="pre">geoserver</span></tt> is encrypted to <tt class="docutils literal"><span class="pre">crypt1:KWhO7jrTz/Gi0oTQRKsVeCmWIZY5VZaD</span></tt>.
<tt class="docutils literal"><span class="pre">crypt1</span></tt> indicates the usage of Weak PBE. The prefix for Strong PBE is <tt class="docutils literal"><span class="pre">crypt2</span></tt>. The ciphertext and the salt are base 64 encoded.</p>
<div class="admonition note" id="sec-passwd-encryption-policies">
<p class="first admonition-title">Note</p>
<p>Strong PBE is not natively available on all Java virtual machines and may require the installation of some additional <a class="reference external" href="http://www.oracle.com/technetwork/java/javase/downloads/jce-6-download-429243.html">JCE Unlimited Strength Jurisdiction</a> policy files:</p>
<ul class="last simple">
<li><a class="reference external" href="http://www.oracle.com/technetwork/java/javase/downloads/jce-6-download-429243.html">Oracle JCE policy jars</a> for Oracle JVM</li>
<li><a class="reference external" href="https://www14.software.ibm.com/webapp/iwm/web/preLogin.do?source=jcesdk">IBM JCE policy jars</a> for IBM JVM</li>
</ul>
</div>
</div>
<div class="section" id="reversible-encryption">
<span id="sec-passwd-reversible"></span><h3>Reversible encryption<a class="headerlink" href="#reversible-encryption" title="Permalink to this headline">¶</a></h3>
<p>Password encryption methods can be <strong>reversible</strong>, meaning that it is possible (and desirable) to obtain the plain-text password from its encrypted version. Reversible passwords are necessary for database connections or external OGC services such as <a class="reference internal" href="../data/cascaded/wms.html#data-external-wms"><em>cascading WMS</em></a> and <a class="reference internal" href="../data/cascaded/wfs.html#data-external-wfs"><em>cascading WFS</em></a>, since GeoServer must be able to decode the encrypted password and pass it to the external service. Plain text and PBE passwords are reversible.</p>
<p>Non-reversible passwords provide the highest level of security, and therefore should be used for user accounts and wherever else possible. Using password digesting is highly recommended, the installation of the unrestricted policy files is not required.</p>
</div>
</div>
<div class="section" id="secret-keys-and-the-keystore">
<span id="sec-passwd-keystore"></span><h2>Secret keys and the keystore<a class="headerlink" href="#secret-keys-and-the-keystore" title="Permalink to this headline">¶</a></h2>
<p>For a reversible password to provide a meaningful level of security, access to the password must be restricted in some way. In GeoServer, encrypting and decrypting passwords involves the generation of secret shared keys, stored in a typical Java <em>keystore</em>. GeoServer uses its own keystore for this purpose named <tt class="docutils literal"><span class="pre">geoserver.jceks</span></tt> which is located in the <tt class="docutils literal"><span class="pre">security</span></tt> directory in the GeoServer data directory. This file is stored in the <a class="reference external" href="http://www.itworld.com/nl/java_sec/07202001">JCEKS format rather than the default JKS</a>. JKS does not support storing shared keys.</p>
<p>The GeoServer keystore is password protected with a <a class="reference internal" href="#sec-master-passwd"><em>Master password</em></a>. It is possible to access the contents of the keystore with external tools such as <a class="reference external" href="http://docs.oracle.com/javase/6/docs/technotes/tools/solaris/keytool.html">keytool</a>. For example, this following command would prompt for the master password and list the contents of the keystore:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>keytools -list -keystore geoserver.jceks -storetype <span class="s2">&quot;JCEKS&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="master-password">
<span id="sec-master-passwd"></span><h2>Master password<a class="headerlink" href="#master-password" title="Permalink to this headline">¶</a></h2>
<p>It is also possible to set a <strong>master password</strong> for GeoServer. This password serves two purposes:</p>
<ul class="simple">
<li>Protect access to the <a class="reference internal" href="#sec-passwd-keystore"><em>keystore</em></a></li>
<li>Protect access to the GeoServer <a class="reference internal" href="root.html#sec-root"><em>Root account</em></a></li>
</ul>
<p>By default, the master password is generated and stored in a file named <tt class="docutils literal"><span class="pre">security/masterpw.info</span></tt> using plain text. When upgrading from an existing GeoServer data directory (versions 2.1.x and lower), the algorithm attempts to figure out the password of a user with the role <tt class="docutils literal"><span class="pre">ROLE_ADMINISTRATOR</span></tt>. If such a password is found and the password length is 8 characters at minimum, GeoServer uses this password as master password. Again, the name of the chosen user is found in <tt class="docutils literal"><span class="pre">security/masterpw.info</span></tt>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The file <tt class="docutils literal"><span class="pre">security/masterpw.info</span></tt> is a security risk. The administrator should read this file and verify the master password by logging on GeoServer as the <tt class="docutils literal"><span class="pre">root</span></tt> user. On success, this file should be removed.</p>
</div>
<p>Refer to <a class="reference internal" href="../webadmin/security/passwords.html#webadmin-sec-masterpasswordprovider"><em>Active master password provider</em></a> for information on how to change the master password.</p>
</div>
<div class="section" id="password-policies">
<span id="sec-passwd-policy"></span><h2>Password policies<a class="headerlink" href="#password-policies" title="Permalink to this headline">¶</a></h2>
<p>A password policy defines constraints on passwords such as password length, case, and required mix of character classes. Password policies are specified when adding <a class="reference internal" href="usergrouprole/usergroupservices.html#sec-rolesystem-usergroupservices"><em>User/group services</em></a> and are used to constrain passwords when creating new users and when changing passwords of existing users.</p>
<p>Each user/group service uses a password policy to enforce these rules. The default GeoServer password policy implementation supports the following optional constraints:</p>
<ul class="simple">
<li>Passwords must contain at least one number</li>
<li>Passwords must contain at least one upper case letter</li>
<li>Passwords must contain at least one lower case letter</li>
<li>Password minimum length</li>
<li>Password maximum length</li>
</ul>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="auth/providers.html" title="previous chapter">Authentication providers</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="root.html" title="next chapter">Root account</a></div>
      </div>
      </div><!-- /#content> -->
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Passwords</a><ul>
<li><a class="reference internal" href="#password-encryption">Password encryption</a><ul>
<li><a class="reference internal" href="#empty">Empty</a></li>
<li><a class="reference internal" href="#plain-text">Plain text</a></li>
<li><a class="reference internal" href="#digest">Digest</a></li>
<li><a class="reference internal" href="#password-based-encryption">Password-based encryption</a></li>
<li><a class="reference internal" href="#reversible-encryption">Reversible encryption</a></li>
</ul>
</li>
<li><a class="reference internal" href="#secret-keys-and-the-keystore">Secret keys and the keystore</a></li>
<li><a class="reference internal" href="#master-password">Master password</a></li>
<li><a class="reference internal" href="#password-policies">Password policies</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="auth/providers.html" title="previous chapter">Authentication providers</a></li>
            <li>Next: <a href="root.html" title="next chapter">Root account</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../_sources/security/passwd.txt">Show Source</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright GeoServer.
    Last updated on Jan 04, 2013.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>