
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Complex Features &mdash; GeoServer 2.2.x User Manual</title>
  <link rel="stylesheet" href="../../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../_static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.2.x',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../searchindex.js"></script>
      <link rel="top" title="GeoServer 2.2.x User Manual" href="../../index.html" />
      <link rel="up" title="Working with Application Schemas" href="index.html" />
      <link rel="next" title="Installation" href="installation.html" />
      <link rel="prev" title="Working with Application Schemas" href="index.html" />
</head>
<body class="data/app-schema/complex-features">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../index.html">GeoServer 2.2.x User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/display/GEOS/What+is+Geoserver">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/display/GEOS/Download">Download</a></li>
        <li><a href="../../index.html">Documentation</a></li>
      </ul>
        <form id="quick-search" action="../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../_static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../index.html">GeoServer 2.2.x User Manual</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">Working with Application Schemas</a> &raquo;</li>
  <li>Complex Features</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="installation.html" title="Installation"
       accesskey="N">next</a></li>
  <li>
    <a href="index.html" title="Working with Application Schemas"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="complex-features">
<span id="app-schema-complex-features"></span><h1>Complex Features<a class="headerlink" href="#complex-features" title="Permalink to this headline">¶</a></h1>
<p>To understand complex features, and why you would want use them, you first need
to know a little about simple features.</p>
<div class="section" id="simple-features">
<h2>Simple features<a class="headerlink" href="#simple-features" title="Permalink to this headline">¶</a></h2>
<p>A common use of GeoServer WFS is to connect to a data source such as a database
and access one or more tables, where each table is treated as a WFS simple feature type.
Simple features contain a list of properties that each have one piece of simple information such as a string or number.
(Special provision is made for geometry objects, which are treated like single items of simple data.)
The Open Geospatial Consortium (OGC) defines three Simple Feature profiles; SF-0, SF-1, and SF-2.
GeoServer simple features are close to OGC SF-0, the simplest OGC profile.</p>
<p>GeoServer WFS simple features provide a straightforward mapping from a database table or
similar structure to a &#8220;flat&#8221; XML representation, where every column of the table maps to
an XML element that usually contains no further structure.
One reason why GeoServer WFS is so easy to use with simple features is that the conversion
from columns in a database table to XML elements is automatic. The name of each element is the
name of the column, in the namespace of the data store. The name of the feature type defaults to
the name of the table. GeoServer WFS can manufacture an XSD type definition for every simple feature type it serves.
Submit a DescribeFeatureType request to see it.</p>
<div class="section" id="benefits-of-simple-features">
<h3>Benefits of simple features<a class="headerlink" href="#benefits-of-simple-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Easy to implement</li>
<li>Fast</li>
<li>Support queries on properies, including spatial queries on geometries</li>
</ul>
</div>
<div class="section" id="drawbacks-of-simple-features">
<h3>Drawbacks of simple features<a class="headerlink" href="#drawbacks-of-simple-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>When GeoServer automatically generates an XSD, the XML format is tied to the database schema.</li>
<li>To share data with GeoServer simple features, participants must either use the same database schema or translate between different schemas.</li>
<li>Even if a community could agree on a single database schema, as more data owners with different data are added to a community, the number of columns in the table becomes unmanageable.</li>
<li>Interoperability is difficult because simple features do not allow modification of only part of the schema.</li>
</ul>
</div>
<div class="section" id="simple-feature-example">
<h3>Simple feature example<a class="headerlink" href="#simple-feature-example" title="Permalink to this headline">¶</a></h3>
<p>For example, if we had a database table <tt class="docutils literal"><span class="pre">stations</span></tt> containing information about GPS stations:</p>
<div class="highlight-python"><pre>| id | code |      name      |         location         |
+----+------+----------------+--------------------------+
| 27 | ALIC | Alice Springs  | POINT(133.8855 -23.6701) |
| 4  | NORF | Norfolk Island | POINT(167.9388 -29.0434) |
| 12 | COCO | Cocos          | POINT(96.8339 -12.1883)  |
| 31 | ALBY | Albany         | POINT(117.8102 -34.9502) |</pre>
</div>
<p>GeoServer would then be able to create the following simple feature WFS response fragment:</p>
<div class="highlight-python"><pre>&lt;gps:stations gml:id="stations.27"&gt;
    &lt;gps:code&gt;ALIC&lt;/gps:code&gt;
    &lt;gps:name&gt;Alice Springs&lt;/gps:name&gt;
    &lt;gps:location&gt;
        &lt;gml:Point srsName="urn:x-ogc:def:crs:EPSG:4326"&gt;
            &lt;gml:pos&gt;-23.6701 133.8855&lt;/gml:pos&gt;
        &lt;/gml:Point&gt;
    &lt;/gps:location&gt;
&lt;/gps:stations&gt;</pre>
</div>
<ul class="simple">
<li>Every row in the table is converted into a feature.</li>
<li>Every column in the table is converted into an element, which contains the value for that row.</li>
<li>Every element is in the namespace of the data store.</li>
<li>Automatic conversions are applied to some special types like geometries, which have internal structure, and include elements defined in GML.</li>
</ul>
</div>
</div>
<div class="section" id="id1">
<h2>Complex features<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Complex features contain properties that can contain further nested properties to arbitrary depth. In particular,
complex features can contain properties that are other complex features. Complex features can be used to represent
information not as an XML view of a single table, but as a collection of related objects of different types.</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Simple feature</th>
<th class="head">Complex feature</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Properties are single data item, e.g. text, number, geometry</td>
<td>Properties can be complex, including complex features</td>
</tr>
<tr class="row-odd"><td>XML view of a single table</td>
<td>Collection of related identifiable objects</td>
</tr>
<tr class="row-even"><td>Schema automatically generated based on database</td>
<td>Schema agreed by community</td>
</tr>
<tr class="row-odd"><td>One large type</td>
<td>Multiple different types</td>
</tr>
<tr class="row-even"><td>Straightforward</td>
<td>Richly featured data standards</td>
</tr>
<tr class="row-odd"><td>Interoperability relies on simplicity and customisation</td>
<td>Interoperability through standardisation</td>
</tr>
</tbody>
</table>
<div class="section" id="benefits-of-complex-features">
<h3>Benefits of complex features<a class="headerlink" href="#benefits-of-complex-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Can define information model as an object-oriented structure, an <em>application schema</em>.</li>
<li>Information is modelled not as a single table but as a collection of related objects whose associations and types may vary from feature to feature (polymorphism), permitting rich expression of content.</li>
<li>By breaking the schema into a collection of independent types, communities need only extend those types they need to modify. This simplifies governance and permits interoperability between related communities who can agree on common base types but need not agree on application-specific subtypes..</li>
</ul>
</div>
<div class="section" id="drawbacks-of-complex-features">
<h3>Drawbacks of complex features<a class="headerlink" href="#drawbacks-of-complex-features" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>More complex to implement</li>
<li>Complex responses might slower if more database queries are required for each feature.</li>
<li>Information modelling is required to standardise an application schema. While this is beneficial, it requires effort from the user community.</li>
</ul>
</div>
<div class="section" id="complex-feature-example">
<h3>Complex feature example<a class="headerlink" href="#complex-feature-example" title="Permalink to this headline">¶</a></h3>
<p>Let us return to our <tt class="docutils literal"><span class="pre">stations</span></tt> table and supplement it with a foreign key <tt class="docutils literal"><span class="pre">gu_id</span></tt> that describes
the relationship between the GPS station and the geologic unit to which it is
physically attached:</p>
<div class="highlight-python"><pre>| id | code |      name      |         location         | gu_id |
+----+------+----------------+--------------------------+-------+
| 27 | ALIC | Alice Springs  | POINT(133.8855 -23.6701) | 32785 |
| 4  | NORF | Norfolk Island | POINT(167.9388 -29.0434) | 10237 |
| 12 | COCO | Cocos          | POINT(96.8339 -12.1883)  | 19286 |
| 31 | ALBY | Albany         | POINT(117.8102 -34.9502) | 92774 |</pre>
</div>
<p>The geologic unit is is stored in the table <tt class="docutils literal"><span class="pre">geologicunit</span></tt>:</p>
<div class="highlight-python"><pre>| gu_id |                       urn             |         text        |
+-------+---------------------------------------+---------------------+
| 32785 | urn:x-demo:feature:GeologicUnit:32785 | Metamorphic bedrock |
...</pre>
</div>
<p>The simple features approach would be to join the <tt class="docutils literal"><span class="pre">stations</span></tt> table with the <tt class="docutils literal"><span class="pre">geologicunit</span></tt>
table into one view and then deliver &#8220;flat&#8221; XML that contained all the properties of both.
The complex feature approach is to deliver the two tables as separate feature types.
This allows the relationship between the entities to be represented while preserving their individual identity.</p>
<p>For example, we could map the GPS station to a <tt class="docutils literal"><span class="pre">sa:SamplingPoint</span></tt> with a <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt>.
The these types are defined in the following application schemas respectively:</p>
<ul>
<li><p class="first"><a class="reference external" href="http://schemas.opengis.net/sampling/1.0.0/sampling.xsd">http://schemas.opengis.net/sampling/1.0.0/sampling.xsd</a></p>
<blockquote>
<div><ul class="simple">
<li>Documentation: OGC 07-002r3: <a class="reference external" href="http://portal.opengeospatial.org/files/?artifact_id=22467">http://portal.opengeospatial.org/files/?artifact_id=22467</a></li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><a class="reference external" href="http://www.geosciml.org/geosciml/2.0/xsd/geosciml.xsd">http://www.geosciml.org/geosciml/2.0/xsd/geosciml.xsd</a></p>
<blockquote>
<div><ul class="simple">
<li>Documentation: <a class="reference external" href="http://www.geosciml.org/geosciml/2.0/doc/">http://www.geosciml.org/geosciml/2.0/doc/</a></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>The complex feature WFS response fragment could then be encoded as:</p>
<div class="highlight-python"><pre>&lt;sa:SamplingPoint gml:id="stations.27&gt;
  &lt;gml:name codeSpace="urn:x-demo:SimpleName"&gt;Alice Springs&lt;/gml:name&gt;
  &lt;gml:name codeSpace="urn:x-demo:IGS:ID"&gt;ALIC&lt;/gml:name&gt;
  &lt;sa:sampledFeature&gt;
     &lt;gsml:GeologicUnit gml:id="geologicunit.32785"&gt;
         &lt;gml:description&gt;Metamorphic bedrock&lt;/gml:description&gt;
         &lt;gml:name codeSpace="urn:x-demo:Feature"&gt;urn:x-demo:feature:GeologicUnit:32785&lt;/gml:name&gt;
     &lt;/gsml:GeologicUnit&gt;
  &lt;/sa:sampledFeature&gt;
  &lt;sa:relatedObservation xlink:href="urn:x-demo:feature:GeologicUnit:32785" /&gt;
  &lt;sa:position&gt;
      &lt;gml:Point srsName="urn:x-ogc:def:crs:EPSG:4326"&gt;
          &lt;gml:pos&gt;-23.6701 133.8855&lt;/gml:pos&gt;
      &lt;/gml:Point&gt;
  &lt;/sa:position&gt;
&lt;/sa:SamplingPoint&gt;</pre>
</div>
<ul class="simple">
<li>The property <tt class="docutils literal"><span class="pre">sa:sampledFeature</span></tt> can reference any other feature type, inline (included in the response) or by reference (an <tt class="docutils literal"><span class="pre">xlink:href</span></tt> URL or URN). This is an example of the use of polymorphism.</li>
<li>The property <tt class="docutils literal"><span class="pre">sa:relatedObservation</span></tt> refers to the same GeologicUnit as <tt class="docutils literal"><span class="pre">sa:sampledFeature</span></tt>, but by reference.</li>
<li>Derivation of new types provides an extension point, allowing information models to be reused and extended in a way that supports backwards compatibility.</li>
<li>Multiple sampling points can share a single GeologicUnit. Application schemas can also define multivalued properties to support many-to-one or many-to-many associations.</li>
<li>Each GeologicUnit could have further properties describing in detail the properties of the rock, such as colour, weathering, lithology, or relevant geologic events.</li>
<li>The GeologicUnit feature type can be served separately, and could be uniquely identified through its properties as the same instance seen in the SamplingPoint.</li>
</ul>
</div>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="index.html" title="previous chapter">Working with Application Schemas</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="installation.html" title="next chapter">Installation</a></div>
      </div>
      </div><!-- /#content> -->
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Complex Features</a><ul>
<li><a class="reference internal" href="#simple-features">Simple features</a><ul>
<li><a class="reference internal" href="#benefits-of-simple-features">Benefits of simple features</a></li>
<li><a class="reference internal" href="#drawbacks-of-simple-features">Drawbacks of simple features</a></li>
<li><a class="reference internal" href="#simple-feature-example">Simple feature example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id1">Complex features</a><ul>
<li><a class="reference internal" href="#benefits-of-complex-features">Benefits of complex features</a></li>
<li><a class="reference internal" href="#drawbacks-of-complex-features">Drawbacks of complex features</a></li>
<li><a class="reference internal" href="#complex-feature-example">Complex feature example</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="index.html" title="previous chapter">Working with Application Schemas</a></li>
            <li>Next: <a href="installation.html" title="next chapter">Installation</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../../_sources/data/app-schema/complex-features.txt">Show Source</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright GeoServer.
    Last updated on Jan 04, 2013.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>