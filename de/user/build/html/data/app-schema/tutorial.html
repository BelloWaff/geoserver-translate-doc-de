
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Tutorial &mdash; GeoServer 2.2.x User Manual</title>
  <link rel="stylesheet" href="../../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../_static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.2.x',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../searchindex.js"></script>
      <link rel="top" title="GeoServer 2.2.x User Manual" href="../../index.html" />
      <link rel="up" title="Working with Application Schemas" href="index.html" />
      <link rel="next" title="Working with Cascaded Services" href="../cascaded/index.html" />
      <link rel="prev" title="Joining Support For Performance" href="joining.html" />
</head>
<body class="data/app-schema/tutorial">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../index.html">GeoServer 2.2.x User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/display/GEOS/What+is+Geoserver">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/display/GEOS/Download">Download</a></li>
        <li><a href="../../index.html">Documentation</a></li>
      </ul>
        <form id="quick-search" action="../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../_static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../index.html">GeoServer 2.2.x User Manual</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">Working with Application Schemas</a> &raquo;</li>
  <li>Tutorial</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../cascaded/index.html" title="Working with Cascaded Services"
       accesskey="N">next</a></li>
  <li>
    <a href="joining.html" title="Joining Support For Performance"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="tutorial">
<span id="app-schema-tutorial"></span><h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial demonstrates how to configure two complex feature types using the app-schema plugin and data from two property files.</p>
<div class="section" id="geosciml">
<h2>GeoSciML<a class="headerlink" href="#geosciml" title="Permalink to this headline">¶</a></h2>
<p>This example uses <a class="reference external" href="http://geosciml.org/geosciml/2.0/doc/">Geoscience Markup Language (GeoSciML) 2.0</a>, a GML application schema:</p>
<blockquote>
<div><em>&#8220;GeoSciML is an application schema that specifies a set of feature-types and supporting structures for information used in the solid-earth geosciences.&#8221;</em></div></blockquote>
<p>The tutorial defines two feature types:</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt>, which describes &#8220;a body of material in the Earth&#8221;.</li>
<li><tt class="docutils literal"><span class="pre">gsml:MappedFeature</span></tt>, which describes the representation on a map of a feature, in this case <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt>.</li>
</ol>
<p>Because a single <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt> can be observed at several distinct locations on the Earth&#8217;s surface, it can have a multivalued <tt class="docutils literal"><span class="pre">gsml:occurrence</span></tt> property, each being a <tt class="docutils literal"><span class="pre">gsml:MappedFeature</span></tt>.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Install GeoServer as usual.</p>
</li>
<li><p class="first">Install the app-schema plugin <tt class="docutils literal"><span class="pre">geoserver-*-app-schema-plugin.zip</span></tt>:</p>
<blockquote>
<div><ul>
<li><p class="first">Place the jar files in <tt class="docutils literal"><span class="pre">WEB-INF/lib</span></tt>.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">tutorial</span></tt> folder contains the GeoServer configuraration (data directory) used for this tutorial.</p>
<blockquote>
<div><ul class="simple">
<li>Either replace your existing <tt class="docutils literal"><span class="pre">data</span></tt> directory with the tutorial data directory,</li>
<li>Or edit <tt class="docutils literal"><span class="pre">WEB-INF/web.xml</span></tt> to set <tt class="docutils literal"><span class="pre">GEOSERVER_DATA_DIR</span></tt> to point to the tutorial data directory. (Be sure to uncomment the section that sets <tt class="docutils literal"><span class="pre">GEOSERVER_DATA_DIR</span></tt>.)</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Perform any configuration required by your servlet container, and then start the servlet. For example, if you are using Tomcat, configure a new context in <tt class="docutils literal"><span class="pre">server.xml</span></tt> and then restart Tomcat.</p>
</li>
<li><p class="first">The first time GeoServer starts with the tutorial configuration, it will download all the schema (XSD) files it needs and store them in the <tt class="docutils literal"><span class="pre">app-schema-cache</span></tt> folder in the data directory. <strong>You must be connected to the internet for this to work.</strong></p>
</li>
</ul>
</div>
<div class="section" id="datastore-xml">
<h2>datastore.xml<a class="headerlink" href="#datastore-xml" title="Permalink to this headline">¶</a></h2>
<p>Each data store configuration file <tt class="docutils literal"><span class="pre">datastore.xml</span></tt> specifies the location of a mapping file and triggers its loading as an app-schema data source. This file should not be confused with the source data store, which is specified inside the mapping file.</p>
<p>For <tt class="docutils literal"><span class="pre">gsml_GeologicUnit</span></tt> the file is <tt class="docutils literal"><span class="pre">workspaces/gsml/gsml_GeologicUnit/datastore.xml</span></tt>:</p>
<div class="highlight-python"><pre>&lt;dataStore&gt;
    &lt;id&gt;gsml_GeologicUnit_datastore&lt;/id&gt;
    &lt;name&gt;gsml_GeologicUnit&lt;/name&gt;
    &lt;enabled&gt;true&lt;/enabled&gt;
    &lt;workspace&gt;
        &lt;id&gt;gsml_workspace&lt;/id&gt;
    &lt;/workspace&gt;
    &lt;connectionParameters&gt;
        &lt;entry key="namespace"&gt;urn:cgi:xmlns:CGI:GeoSciML:2.0&lt;/entry&gt;
        &lt;entry key="url"&gt;file:workspaces/gsml/gsml_GeologicUnit/gsml_GeologicUnit.xml&lt;/entry&gt;
        &lt;entry key="dbtype"&gt;app-schema&lt;/entry&gt;
    &lt;/connectionParameters&gt;
&lt;/dataStore&gt;</pre>
</div>
<p>For <tt class="docutils literal"><span class="pre">gsml:MappedFeature</span></tt> the file is <tt class="docutils literal"><span class="pre">workspaces/gsml/gsml_MappedFeature/datastore.xml</span></tt>:</p>
<div class="highlight-python"><pre>&lt;dataStore&gt;
    &lt;id&gt;gsml_MappedFeature_datastore&lt;/id&gt;
    &lt;name&gt;gsml_MappedFeature&lt;/name&gt;
    &lt;enabled&gt;true&lt;/enabled&gt;
    &lt;workspace&gt;
        &lt;id&gt;gsml_workspace&lt;/id&gt;
    &lt;/workspace&gt;
    &lt;connectionParameters&gt;
        &lt;entry key="namespace"&gt;urn:cgi:xmlns:CGI:GeoSciML:2.0&lt;/entry&gt;
        &lt;entry key="url"&gt;file:workspaces/gsml/gsml_MappedFeature/gsml_MappedFeature.xml&lt;/entry&gt;
        &lt;entry key="dbtype"&gt;app-schema&lt;/entry&gt;
    &lt;/connectionParameters&gt;
&lt;/dataStore&gt;</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ensure that there is no whitespace inside an <tt class="docutils literal"><span class="pre">entry</span></tt> element.</p>
</div>
</div>
<div class="section" id="mapping-files">
<h2>Mapping files<a class="headerlink" href="#mapping-files" title="Permalink to this headline">¶</a></h2>
<p>Configuration of app-schema feature types is performed in mapping files:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">workspaces/gsml/gsml_GeologicUnit/gsml_GeologicUnit.xml</span></tt></li>
<li><tt class="docutils literal"><span class="pre">workspaces/gsml/gsml_MappedFeature/gsml_MappedFeature.xml</span></tt></li>
</ul>
<div class="section" id="namespaces">
<h3>Namespaces<a class="headerlink" href="#namespaces" title="Permalink to this headline">¶</a></h3>
<p>Each mapping file contains namespace prefix definitions:</p>
<div class="highlight-python"><pre>&lt;Namespace&gt;
    &lt;prefix&gt;gml&lt;/prefix&gt;
    &lt;uri&gt;http://www.opengis.net/gml&lt;/uri&gt;
&lt;/Namespace&gt;
&lt;Namespace&gt;
    &lt;prefix&gt;gsml&lt;/prefix&gt;
    &lt;uri&gt;urn:cgi:xmlns:CGI:GeoSciML:2.0&lt;/uri&gt;
&lt;/Namespace&gt;
&lt;Namespace&gt;
    &lt;prefix&gt;xlink&lt;/prefix&gt;
    &lt;uri&gt;http://www.w3.org/1999/xlink&lt;/uri&gt;
&lt;/Namespace&gt;</pre>
</div>
<p>Only those namespace prefixes used in the mapping file need to be declared, so the mapping file for <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt> has less.</p>
</div>
<div class="section" id="source-data-store">
<h3>Source data store<a class="headerlink" href="#source-data-store" title="Permalink to this headline">¶</a></h3>
<p>The data for this tutorial is contained in two property files:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">workspaces/gsml/gsml_GeologicUnit/gsml_GeologicUnit.properties</span></tt></li>
<li><tt class="docutils literal"><span class="pre">workspaces/gsml/gsml_MappedFeature/gsml_MappedFeature.properties</span></tt></li>
</ul>
<p><a class="reference internal" href="../vector/properties.html#data-java-properties"><em>Java Properties</em></a> describes the format of property files.</p>
<p>For this example, each feature type uses an identical source data store configuration. This <tt class="docutils literal"><span class="pre">directory</span></tt> parameter indicates that the source data is contained in property files named by their feature type, in the same directory as the corresponding mapping file:</p>
<div class="highlight-python"><pre>&lt;sourceDataStores&gt;
     &lt;DataStore&gt;
         &lt;id&gt;datastore&lt;/id&gt;
         &lt;parameters&gt;
             &lt;Parameter&gt;
                 &lt;name&gt;directory&lt;/name&gt;
                 &lt;value&gt;file:./&lt;/value&gt;
             &lt;/Parameter&gt;
         &lt;/parameters&gt;
     &lt;/DataStore&gt;
 &lt;/sourceDataStores&gt;</pre>
</div>
<p>See <a class="reference internal" href="data-stores.html#app-schema-data-stores"><em>Data Stores</em></a> for a description of how to use other types of data stores such as databases.</p>
</div>
<div class="section" id="target-types">
<h3>Target types<a class="headerlink" href="#target-types" title="Permalink to this headline">¶</a></h3>
<p>Both feature types are defined by the same XML Schema, the top-level schema for GeoSciML 2.0. This is specified in the <tt class="docutils literal"><span class="pre">targetTypes</span></tt> section. The type of the output feature is defined in <tt class="docutils literal"><span class="pre">targetElement</span></tt> in the <tt class="docutils literal"><span class="pre">typeMapping</span></tt> section below:</p>
<div class="highlight-python"><pre>&lt;targetTypes&gt;
    &lt;FeatureType&gt;
        &lt;schemaUri&gt;http://www.geosciml.org/geosciml/2.0/xsd/geosciml.xsd&lt;/schemaUri&gt;
    &lt;/FeatureType&gt;
&lt;/targetTypes&gt;</pre>
</div>
<p>In this case the schema is published, but because the OASIS XML Catalog is used for schema resolution, a private or modified schema in the catalog can be used if desired.</p>
</div>
<div class="section" id="mappings">
<h3>Mappings<a class="headerlink" href="#mappings" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">typeMappings</span></tt> element begins with configuration elements. From the mapping file for <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt>:</p>
<div class="highlight-python"><pre>&lt;typeMappings&gt;
    &lt;FeatureTypeMapping&gt;
        &lt;sourceDataStore&gt;datastore&lt;/sourceDataStore&gt;
        &lt;sourceType&gt;gsml_GeologicUnit&lt;/sourceType&gt;
        &lt;targetElement&gt;gsml:GeologicUnit&lt;/targetElement&gt;</pre>
</div>
<ul class="simple">
<li>The mapping starts with <tt class="docutils literal"><span class="pre">sourceDataStore</span></tt>, which gives the arbitrary identifier used above to name the source of the input data in the <tt class="docutils literal"><span class="pre">sourceDataStores</span></tt> section.</li>
<li><tt class="docutils literal"><span class="pre">sourceType</span></tt> gives the name of the source simple feature type. In this case it is the simple feature type <tt class="docutils literal"><span class="pre">gsml_GeologicUnit</span></tt>, sourced from the rows of the file <tt class="docutils literal"><span class="pre">gsml_GeologicUnit.properties</span></tt> in the same directory as the mapping file.</li>
<li>When working with databases <tt class="docutils literal"><span class="pre">sourceType</span></tt> is the name of a table or view. Database identifiers must be lowercase for PostGIS or uppercase for Oracle Spatial.</li>
<li><tt class="docutils literal"><span class="pre">targetElement</span></tt> is the name of the output complex feature type.</li>
</ul>
</div>
<div class="section" id="gml-id-mapping">
<h3>gml:id mapping<a class="headerlink" href="#gml-id-mapping" title="Permalink to this headline">¶</a></h3>
<p>The first mapping sets the <tt class="docutils literal"><span class="pre">gml:id</span></tt> to be the feature id specified in the source property file:</p>
<div class="highlight-python"><pre>&lt;AttributeMapping&gt;
    &lt;targetAttribute&gt;
        gsml:GeologicUnit
    &lt;/targetAttribute&gt;
    &lt;idExpression&gt;
        &lt;OCQL&gt;getId()&lt;/OCQL&gt;
    &lt;/idExpression&gt;
&lt;/AttributeMapping&gt;</pre>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">targetAttribute</span></tt> is the XPath to the element for which the mapping applies, in this case, the top-level feature type.</li>
<li><tt class="docutils literal"><span class="pre">idExpression</span></tt> is a special form that can only be used to set the <tt class="docutils literal"><span class="pre">gml:id</span></tt> on a feature. For database sources, <tt class="docutils literal"><span class="pre">getId()</span></tt> will synthesise an id from the table or view name, a dot &#8221;.&#8221;, and the primary key of the table. If this is not desirable, any other field or CQL expression can be used, if it evaluates to an <a class="reference external" href="http://www.w3.org/TR/1999/REC-xml-names-19990114/#NT-NCName">NCName</a>.</li>
</ul>
</div>
<div class="section" id="ordinary-mapping">
<h3>Ordinary mapping<a class="headerlink" href="#ordinary-mapping" title="Permalink to this headline">¶</a></h3>
<p>Most mappings consist of a target and source. Here is one from <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt>:</p>
<div class="highlight-python"><pre>&lt;AttributeMapping&gt;
    &lt;targetAttribute&gt;
        gml:description
        &lt;/targetAttribute&gt;
    &lt;sourceExpression&gt;
        &lt;OCQL&gt;DESCRIPTION&lt;/OCQL&gt;
    &lt;/sourceExpression&gt;
&lt;/AttributeMapping&gt;</pre>
</div>
<ul class="simple">
<li>In this case, the value of <tt class="docutils literal"><span class="pre">gml:description</span></tt> is just the value of the <tt class="docutils literal"><span class="pre">DESCRIPTION</span></tt> field in the property file.</li>
<li>For a database, the field name is the name of the column (the table/view is set in <tt class="docutils literal"><span class="pre">sourceType</span></tt> above). Database identifiers must be lowercase for PostGIS or uppercase for Oracle Spatial.</li>
<li>CQL expressions can be used to calculate content. Use caution because queries on CQL-calculated values prevent the construction of efficient SQL queries.</li>
<li>Source expressions can be CQL literals, which are single-quoted.</li>
</ul>
</div>
<div class="section" id="client-properties">
<h3>Client properties<a class="headerlink" href="#client-properties" title="Permalink to this headline">¶</a></h3>
<p>In addition to the element content, a mapping can set one or more &#8220;client properties&#8221; (XML attributes). Here is one from <tt class="docutils literal"><span class="pre">gsml:MappedFeature</span></tt>:</p>
<div class="highlight-python"><pre>&lt;AttributeMapping&gt;
    &lt;targetAttribute&gt;
        gsml:specification
    &lt;/targetAttribute&gt;
    &lt;ClientProperty&gt;
        &lt;name&gt;xlink:href&lt;/name&gt;
        &lt;value&gt;GU_URN&lt;/value&gt;
    &lt;/ClientProperty&gt;
&lt;/AttributeMapping&gt;</pre>
</div>
<ul class="simple">
<li>This mapping leaves the content of the <tt class="docutils literal"><span class="pre">gsml:specification</span></tt> element empty but sets an <tt class="docutils literal"><span class="pre">xlink:href</span></tt> attribute to the value of the <tt class="docutils literal"><span class="pre">GU_URN</span></tt> field.</li>
<li>Multiple <tt class="docutils literal"><span class="pre">ClientProperty</span></tt> mappings can be set.</li>
</ul>
<p>In this example from the mapping for <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt> both element content and an XML attribute are provided:</p>
<div class="highlight-python"><pre>&lt;AttributeMapping&gt;
    &lt;targetAttribute&gt;
        gml:name[1]
        &lt;/targetAttribute&gt;
    &lt;sourceExpression&gt;
        &lt;OCQL&gt;NAME&lt;/OCQL&gt;
    &lt;/sourceExpression&gt;
    &lt;ClientProperty&gt;
        &lt;name&gt;codeSpace&lt;/name&gt;
        &lt;value&gt;'urn:x-test:classifierScheme:TestAuthority:GeologicUnitName'&lt;/value&gt;
    &lt;/ClientProperty&gt;
&lt;/AttributeMapping&gt;</pre>
</div>
<ul class="simple">
<li>The <tt class="docutils literal"><span class="pre">codespace</span></tt> XML attribute is set to a fixed value by providing a CQL literal.</li>
<li>There are multiple mappings for <tt class="docutils literal"><span class="pre">gml:name</span></tt>, and the index <tt class="docutils literal"><span class="pre">[1]</span></tt> means that this mapping targets the first.</li>
</ul>
</div>
<div class="section" id="targetattributenode">
<h3>targetAttributeNode<a class="headerlink" href="#targetattributenode" title="Permalink to this headline">¶</a></h3>
<p>If the type of a property is abstract, a <tt class="docutils literal"><span class="pre">targetAttributeNode</span></tt> mapping must be used to specify a concrete type. This mapping must occur before the mapping for the content of the property.</p>
<p>Here is an example from the mapping file for <tt class="docutils literal"><span class="pre">gsml:MappedFeature</span></tt>:</p>
<div class="highlight-python"><pre>&lt;AttributeMapping&gt;
    &lt;targetAttribute&gt;gsml:positionalAccuracy&lt;/targetAttribute&gt;
    &lt;targetAttributeNode&gt;gsml:CGI_TermValuePropertyType&lt;/targetAttributeNode&gt;
&lt;/AttributeMapping&gt;
&lt;AttributeMapping&gt;
    &lt;targetAttribute&gt;gsml:positionalAccuracy/gsml:CGI_TermValue/gsml:value&lt;/targetAttribute&gt;
    &lt;sourceExpression&gt;
        &lt;OCQL&gt;'urn:ogc:def:nil:OGC:missing'&lt;/OCQL&gt;
    &lt;/sourceExpression&gt;
    &lt;ClientProperty&gt;
        &lt;name&gt;codeSpace&lt;/name&gt;
        &lt;value&gt;'urn:ietf:rfc:2141'&lt;/value&gt;
    &lt;/ClientProperty&gt;
&lt;/AttributeMapping&gt;</pre>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">gsml:positionalAccuracy</span></tt> is of type <tt class="docutils literal"><span class="pre">gsml:CGI_TermValuePropertyType</span></tt>, which is abstract, so must be mapped to its concrete subtype <tt class="docutils literal"><span class="pre">gsml:CGI_TermValuePropertyType</span></tt> with a <tt class="docutils literal"><span class="pre">targetAttributeNode</span></tt> mapping before its contents can be mapped.</li>
<li>This example also demonstrates that mapping can be applied to nested properties to arbitrary depth. This becomes unmanageable for deep nesting, where feature chaining is preferred.</li>
</ul>
</div>
<div class="section" id="feature-chaining">
<h3>Feature chaining<a class="headerlink" href="#feature-chaining" title="Permalink to this headline">¶</a></h3>
<p>In feature chaining, one feature type is used as a property of an enclosing feature type, by value or by reference:</p>
<div class="highlight-python"><pre>&lt;AttributeMapping&gt;
    &lt;targetAttribute&gt;
        gsml:occurrence
    &lt;/targetAttribute&gt;
    &lt;sourceExpression&gt;
        &lt;OCQL&gt;URN&lt;/OCQL&gt;
        &lt;linkElement&gt;gsml:MappedFeature&lt;/linkElement&gt;
        &lt;linkField&gt;gml:name[2]&lt;/linkField&gt;
    &lt;/sourceExpression&gt;
    &lt;isMultiple&gt;true&lt;/isMultiple&gt;
&lt;/AttributeMapping&gt;</pre>
</div>
<ul class="simple">
<li>In this case from the mapping for <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt>, we specify a mapping for its <tt class="docutils literal"><span class="pre">gsml:occurrence</span></tt>.</li>
<li>The <tt class="docutils literal"><span class="pre">URN</span></tt> field of the source <tt class="docutils literal"><span class="pre">gsml_GeologicUnit</span></tt> simple feature is use as the &#8220;foreign key&#8221;, which maps to the second <tt class="docutils literal"><span class="pre">gml:name</span></tt> in each <tt class="docutils literal"><span class="pre">gsml:MappedFeature</span></tt>.</li>
<li>Every <tt class="docutils literal"><span class="pre">gsml:MappedFeature</span></tt> with <tt class="docutils literal"><span class="pre">gml:name[2]</span></tt> equal to the <tt class="docutils literal"><span class="pre">URN</span></tt> of the <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt> under construction is included as a <tt class="docutils literal"><span class="pre">gsml:occurrence</span></tt> property of the <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt> (by value).</li>
</ul>
</div>
</div>
<div class="section" id="wfs-response">
<h2>WFS response<a class="headerlink" href="#wfs-response" title="Permalink to this headline">¶</a></h2>
<p>When GeoServer is running, test app-schema WFS in a web browser. If GeoServer is listening on <tt class="docutils literal"><span class="pre">localhost:8080</span></tt> you can query the two feature types using these links:</p>
<ul class="simple">
<li><a class="reference external" href="http://localhost:8080/geoserver/wfs?request=GetFeature&amp;version=1.1.0&amp;typeName=gsml:GeologicUnit">http://localhost:8080/geoserver/wfs?request=GetFeature&amp;version=1.1.0&amp;typeName=gsml:GeologicUnit</a></li>
<li><a class="reference external" href="http://localhost:8080/geoserver/wfs?request=GetFeature&amp;version=1.1.0&amp;typeName=gsml:MappedFeature">http://localhost:8080/geoserver/wfs?request=GetFeature&amp;version=1.1.0&amp;typeName=gsml:MappedFeature</a></li>
</ul>
<p>You can also obtain WFS responses by using the <em>Demo requests</em> page in the GeoServer web interface. (Note that the web interface does not yet support app-schema store or layer administration.)</p>
<ul class="simple">
<li><a class="reference external" href="http://localhost:8080/geoserver/web/?wicket:bookmarkablePage=:org.geoserver.web.demo.DemoRequestsPage">http://localhost:8080/geoserver/web/?wicket:bookmarkablePage=:org.geoserver.web.demo.DemoRequestsPage</a></li>
</ul>
<div class="section" id="gsml-geologicunit">
<h3>gsml:GeologicUnit<a class="headerlink" href="#gsml-geologicunit" title="Permalink to this headline">¶</a></h3>
<p>Feature chaining has been used to construct the multivalued property <tt class="docutils literal"><span class="pre">gsml:occurrence</span></tt> of <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt>. This property is a <tt class="docutils literal"><span class="pre">gsml:MappedFeature</span></tt>. The WFS response for <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt> combines the output of both feature types into a single response. The first <tt class="docutils literal"><span class="pre">gsml:GeologicUnit</span></tt> has two <tt class="docutils literal"><span class="pre">gsml:occurrence</span></tt> properties, while the second has one. The relationships between the feature instances are data driven.</p>
<p>Because the mapping files in the tutorial configuration do not contain attribute mappings for all mandatory properties of these feature types, the WFS response is not <em>schema-valid</em> against the GeoSciML 2.0 schemas. Schema-validity can be achieved by adding more attribute mappings to the mapping files.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The data in this tutorial is fictitious. Some of the text and numbers have been taken from real data, but have been modified to the extent that they have no real-world meaning.</p>
</div>
</div>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="joining.html" title="previous chapter">Joining Support For Performance</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="../cascaded/index.html" title="next chapter">Working with Cascaded Services</a></div>
      </div>
      </div><!-- /#content> -->
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Tutorial</a><ul>
<li><a class="reference internal" href="#geosciml">GeoSciML</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#datastore-xml">datastore.xml</a></li>
<li><a class="reference internal" href="#mapping-files">Mapping files</a><ul>
<li><a class="reference internal" href="#namespaces">Namespaces</a></li>
<li><a class="reference internal" href="#source-data-store">Source data store</a></li>
<li><a class="reference internal" href="#target-types">Target types</a></li>
<li><a class="reference internal" href="#mappings">Mappings</a></li>
<li><a class="reference internal" href="#gml-id-mapping">gml:id mapping</a></li>
<li><a class="reference internal" href="#ordinary-mapping">Ordinary mapping</a></li>
<li><a class="reference internal" href="#client-properties">Client properties</a></li>
<li><a class="reference internal" href="#targetattributenode">targetAttributeNode</a></li>
<li><a class="reference internal" href="#feature-chaining">Feature chaining</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wfs-response">WFS response</a><ul>
<li><a class="reference internal" href="#gsml-geologicunit">gsml:GeologicUnit</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="joining.html" title="previous chapter">Joining Support For Performance</a></li>
            <li>Next: <a href="../cascaded/index.html" title="next chapter">Working with Cascaded Services</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../../_sources/data/app-schema/tutorial.txt">Show Source</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright GeoServer.
    Last updated on Jan 04, 2013.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>