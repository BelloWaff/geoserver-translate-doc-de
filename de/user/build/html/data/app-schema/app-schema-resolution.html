
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Application Schema Resolution &mdash; GeoServer 2.2.x User Manual</title>
  <link rel="stylesheet" href="../../_static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../_static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../_static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.2.x',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../_static/jquery.js"></script>
  <script type="text/javascript" src="../../_static/doctools.js"></script>
  <script type="text/javascript" src="../../_static/searchtools.js"></script>
  <script type="text/javascript" src="../../searchindex.js"></script>
      <link rel="top" title="GeoServer 2.2.x User Manual" href="../../index.html" />
      <link rel="up" title="Working with Application Schemas" href="index.html" />
      <link rel="next" title="Supported GML Versions" href="supported-gml-versions.html" />
      <link rel="prev" title="Mapping File" href="mapping-file.html" />
</head>
<body class="data/app-schema/app-schema-resolution">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../index.html">GeoServer 2.2.x User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/display/GEOS/What+is+Geoserver">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/display/GEOS/Download">Download</a></li>
        <li><a href="../../index.html">Documentation</a></li>
      </ul>
        <form id="quick-search" action="../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../_static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../index.html">GeoServer 2.2.x User Manual</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">Working with Application Schemas</a> &raquo;</li>
  <li>Application Schema Resolution</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="supported-gml-versions.html" title="Supported GML Versions"
       accesskey="N">next</a></li>
  <li>
    <a href="mapping-file.html" title="Mapping File"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="application-schema-resolution">
<span id="app-schema-app-schema-resolution"></span><h1>Application Schema Resolution<a class="headerlink" href="#application-schema-resolution" title="Permalink to this headline">¶</a></h1>
<p>To be able to encode XML responses conforming to a GML application schema, the app-schema plugin must be able to locate the application schema files (XSDs) that define the schema. This page describes the schema resolution process.</p>
<div class="section" id="schema-downloading-is-now-automatic-for-most-users">
<h2>Schema downloading is now automatic for most users<a class="headerlink" href="#schema-downloading-is-now-automatic-for-most-users" title="Permalink to this headline">¶</a></h2>
<p>GeoServer will automatically download and cache (see <a class="reference internal" href="#cache">Cache</a> below) all the schemas it needs the first time it starts if:</p>
<ol class="arabic simple">
<li>All the application schemas you use are accessed via http/https URLs, and</li>
<li>Your GeoServer instance is deployed on a network that permits it to download them.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is the recommended way of using GeoServer app-schema for most users.</p>
</div>
<p>If cached downloading is used, no manual handling of schemas will be required. The rest of this page is for those with more complicated arrangements, or who wish to clear the cache.</p>
</div>
<div class="section" id="resolution-order">
<h2>Resolution order<a class="headerlink" href="#resolution-order" title="Permalink to this headline">¶</a></h2>
<p>The order of sources used to resolve application schemas is:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#oasis-catalog">OASIS Catalog</a></li>
<li><a class="reference internal" href="#classpath">Classpath</a></li>
<li><a class="reference internal" href="#cache">Cache</a></li>
</ol>
<p>Every attempt to load a schema works down this list, so imports can be resolved from sources other than that used for the originating document. For example, an application schema in the cache that references a schema found in the catalog will use the version in the catalog, rather than caching it. This allows users to supply unpublished or modified schemas sourced from, for example, the catalog, at the cost of interoperability (how do WFS clients get them?).</p>
</div>
<div class="section" id="oasis-catalog">
<h2>OASIS Catalog<a class="headerlink" href="#oasis-catalog" title="Permalink to this headline">¶</a></h2>
<p>An <a class="reference external" href="http://www.oasis-open.org/committees/entity/spec-2001-08-06.html">OASIS XML Catalog</a> is a standard configuration file format that instructs an XML processing system how to process entity references. The GeoServer app-schema resolver uses catalog URI semantics to locate application schemas, so <tt class="docutils literal"><span class="pre">uri</span></tt> or <tt class="docutils literal"><span class="pre">rewriteURI</span></tt> entries should be present in your catalog. The optional mapping file  <tt class="docutils literal"><span class="pre">catalog</span></tt> element provides the location of the OASIS XML Catalog configuration file, given as a path relative to the mapping file, for example:</p>
<div class="highlight-python"><pre>&lt;catalog&gt;../../../schemas/catalog.xml&lt;/catalog&gt;</pre>
</div>
<p>Earlier versions of the app-schema plugin required all schemas to be present in the catalog. This is no longer the case. Because the catalog is searched first, existing catalog-based deployments will continue to work as before.</p>
<p>To migrate an existing GeoServer app-schema deployment that uses an OASIS Catalog to instead use cached downloads (see <a class="reference internal" href="#cache">Cache</a> below), remove all <tt class="docutils literal"><span class="pre">catalog</span></tt> elements from your mapping files and restart GeoServer.</p>
</div>
<div class="section" id="classpath">
<h2>Classpath<a class="headerlink" href="#classpath" title="Permalink to this headline">¶</a></h2>
<p>Java applications such as GeoServer can load resources from the Java classpath. GeoServer app-schema uses a simple mapping from an http or https URL to a classpath resource location. For example, an application schema published at <tt class="docutils literal"><span class="pre">http://schemas.example.org/exampleml/exml.xsd</span></tt> would be found on the classpath if it was stored either:</p>
<ul class="simple">
<li>at <tt class="docutils literal"><span class="pre">/org/example/schemas/exampleml/exml.xsd</span></tt> in a JAR file on the classpath (for example, a JAR file in <tt class="docutils literal"><span class="pre">WEB-INF/lib</span></tt>) or,</li>
<li>on the local filesystem at <tt class="docutils literal"><span class="pre">WEB-INF/classes/org/example/schemas/exampleml/exml.xsd</span></tt> .</li>
</ul>
<p>The ability to load schemas from the classpath is intended to support testing, but may be useful to users whose communities supply JAR files containing their application schemas.</p>
</div>
<div class="section" id="cache">
<h2>Cache<a class="headerlink" href="#cache" title="Permalink to this headline">¶</a></h2>
<p>If an application schema cannot be found in the catalog or on the classpath, it is downloaded from the network and stored in a subdirectory <tt class="docutils literal"><span class="pre">app-schema-cache</span></tt> of the GeoServer data directory.</p>
<ul class="simple">
<li>Once schemas are downloaded into the cache, they persist indefinitely, including over GeoServer restarts.</li>
<li>No attempt will be made to retrieve new versions of cached schemas.</li>
<li>To clear the cache, remove the  subdirectory <tt class="docutils literal"><span class="pre">app-schema-cache</span></tt> of the GeoServer data directory and restart GeoServer.</li>
</ul>
<p>GeoServer app-schema uses a simple mapping from an http or https URL to local filesystem path. For example, an application schema published at <tt class="docutils literal"><span class="pre">http://schemas.example.org/exampleml/exml.xsd</span></tt> would be downloaded and stored as <tt class="docutils literal"><span class="pre">app-schema-cache/org/example/schemas/exampleml/exml.xsd</span></tt> . Note that:</p>
<ul class="simple">
<li>Only <tt class="docutils literal"><span class="pre">http</span></tt> and <tt class="docutils literal"><span class="pre">https</span></tt> URLs are supported.</li>
<li>Port numbers, queries, and fragments are ignored.</li>
</ul>
<p>If your GeoServer instance is deployed on a network whose firewall rules prevent outgoing TCP connections on port 80 (http) or 443 (https), schema downloading will not work. (For security reasons, some service networks [&#8220;demilitarised zones&#8221;] prohibit such outgoing connections.) If schema downloading is not permitted on your network, there are three solutions:</p>
<ol class="arabic simple">
<li>Either: Install and configure GeoServer on another network that can make outgoing TCP connections, start GeoServer to trigger schema download, and then manually copy the <tt class="docutils literal"><span class="pre">app-schema-cache</span></tt> directory to the production server. This is the easiest option because GeoServer automatically downloads all the schemas it needs, including dependencies.</li>
<li>Or: Deploy JAR files containing all required schema files on the classpath (see <a class="reference internal" href="#classpath">Classpath</a> above).</li>
<li>Or: Use a catalog (see <a class="reference internal" href="#oasis-catalog">OASIS Catalog</a> above).</li>
</ol>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="mapping-file.html" title="previous chapter">Mapping File</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="supported-gml-versions.html" title="next chapter">Supported GML Versions</a></div>
      </div>
      </div><!-- /#content> -->
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Application Schema Resolution</a><ul>
<li><a class="reference internal" href="#schema-downloading-is-now-automatic-for-most-users">Schema downloading is now automatic for most users</a></li>
<li><a class="reference internal" href="#resolution-order">Resolution order</a></li>
<li><a class="reference internal" href="#oasis-catalog">OASIS Catalog</a></li>
<li><a class="reference internal" href="#classpath">Classpath</a></li>
<li><a class="reference internal" href="#cache">Cache</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="mapping-file.html" title="previous chapter">Mapping File</a></li>
            <li>Next: <a href="supported-gml-versions.html" title="next chapter">Supported GML Versions</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../../_sources/data/app-schema/app-schema-resolution.txt">Show Source</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright GeoServer.
    Last updated on Jan 04, 2013.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>